# IP Address                  
                  
## IP地址组成      
**网络号**      
**主机号**      
**掩码**      
      
ipv4：4字节数据，由网络号 + 主机号组成，左边是网络号，右边是主机号                  
ipv6：8字节数据                  
      
网络号：可以理解为网络编号，是主机所属网络的代号。      
主机号：区分网络内不同主机的编号。      
掩码：为了区分网络号和主机号，从IP地址中提取网络号， IP & 掩码 = 网络号                    
      
## IP地址分类      
**A/B/C/D/E类地址**      
**公网/私网地址**      
**单播/组播/广播地址**      
      
IP地址划分      
(1)根据网络号的比特位长度(8/16/24/32)，将IP地址划分为A/B/C/D/E五类。      
(2)根据使用场景不同，A/B/C类IP地址，内部又划分为公网地址和私网地址。      
(3)A/B/C类IP地址，在给定掩码的前提下，主机号全0表示此网段，主机号全      
   1表示广播IP，其余的IP地址可以分配给主机，作为主机IP使用，即单播地址。        
(4)D类地址是组播地址，255.255.255.255是广播地址。      
      
IP表示方法：                
一般使用IP加掩码位数的方法来表示网段，比如，                
192.168.1.0/24                
host id全0，用来表示网段。                
host id全1，用来表示广播地址。                
其他的host id都可以用来分配给网络内所有的计算机。                
                
### A类地址                
网络号首字节最高位必须为0，8位掩码 255.0.0.0                  
**1.x.x.x - 126.x.x.x**                  
容纳主机数量2的24次方                  
**10.x.x.x 为私网地址**                  
127.x.x.x地址保留                  
                  
                  
### B类地址                
网络号首字节最高位，次高位必须是1和0，16位掩码 255.255.0.0                  
**128.0.x.x - 191.255.x.x**                     
容纳主机数量2的16次方                  
**172.16.x.x - 172.31.x.x 为私网地址**                  
                  
                  
### C类地址                
网络号首字节高三位必须是110，24位掩码 255.255.255.0                  
**192.0.0.x - 223.255.255.x**                  
容纳主机数量2的8次方                  
**192.168.x.x 为私网地址**                  
                  
              
### D类地址                  
组播地址，四个字节全部表示网络号。                
**224.0.0.0 - 239.255.255.255**                
                
                  
### E类地址                  
**240.0.0.0 - 255.255.255.255**        
保留        
              
## 划分子网/子网掩码                  
子网划分的意义？      
在给定一段A/B/C类IP地址的前提下，网络内可容纳主机的个数是固定的，为了便于管理，    
在已有掩码的基础上，扩展掩码的位数，将网络划分成更小的网络，即将主机号高字节中    
的高位也用作网络号。    
    
实际应用，比如某公司做网络规划，给定一网段192.168.1.0/24，需要两个部门使用，将    
网络划分为两个子网，最高位用作网络号，192.168.1.0/25，192.168.1.128/25，可用IP    
地址都是128个（实际上是126个）。    
    
经过划分子网后，本来可以直接互通的IP地址，在IP层面则属于不同网段，不能直接通信了。    
比如192.168.1.1/24和192.168.128/24本来都属于C类地址，在进行IP通信时，下层会直接arp    
广播，然后直接通信，修改掩码后，下层则不进行arp广播了，而是要发给网关。      
    
## Linux设置IP地址            
系统ubuntu18.04下，如何手动设置IP地址？              
（1）使用指令              
基本步骤如下：              
ifconfig  [interface]  down             
ifconfig  [interface]  [ip]  netmask  [mask]             
route add default gw [gateway_ip] [interface]           
ifconfig  [interface]  up             
          
**手动配置有线网卡的地址？**          
在ubuntu18下使用指令配置网卡地址时，出现过很多奇怪的现象，比如使用ifconfig配置IP后，            
IP会自动丢失；IP配置好后，内核没有生成对应的路由，导致配置网关失败，也无法正常通信。              
个人感觉，手动配置IP地址跟系统的network-manager软件可能存在冲突，导致网络故障，所以            
ubuntu18下，手动修改IP可以考虑使用network-manager。如果确实需要使用命令行，那么建议            
先把network-manager网络配置中，对应的网卡配置关闭，然后再使用命令行配置。            
          
**手动配置无线网卡的地址？**          
ubuntu下，连接上无线网络后，network-manager会通过DHCP获取地址，如果DHCP获取地址失败，          
network-manager会认为网络连接失败，会自动断开无线连接，这种模式跟很多支持wifi的无线          
设备类似，所以为了手动配置无线网卡的地址，必须将network-manager中，dhcp地址关闭，才          
不会导致因为获取不到地址而断开wifi连接。          
            
（2）使用network-manager            
ubuntu18图形化网络管理软件，配置好IP，需要重启网卡，使配置尽快生效。              
  
## Q&A
问：网络设备的MAC地址原则上是必须全球唯一的，那么为什么不直接使用MAC地址通信，而是又在    
    三层设计IP地址，为什么使用这种双地址的架构？    
答：从技术实现的角度说：MAC地址属于二层地址，数据是根据目的MAC直接转发，属于一个广播域，  
    如果全球所有的设备通过交换机连接，那么一旦交换机泛洪，那么会消耗巨大的通信带宽，网络  
	会瘫痪，所以二层适合局域网内通信，三层IP地址，解决了网络之间的通信问题，路由器可以隔  
	离广播域，通过IP地址可以实现不同网络内主机端到端之间的通信。  
